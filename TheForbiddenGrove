#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <time.h>
#include <conio.h>//Para usar o getch e kbhit
#include <windows.h>//Para usar o sleep
#include <locale.h>//permite acentua  o

#define ALTURA1 10
#define LARGURA1 10 //Altura e largura primeira fase
#define ALTURA2 20
#define LARGURA2 20 //Altura e largura segunda fase
#define ALTURA3 40
#define LARGURA3 41 //Altura e largura terceira fase

//Cores dos mapas
#define BLACK "\033[30m"
#define YELLOW "\x1b[33m"
#define GREEN  "\033[32m"
#define WHITE  "\033[37m"
#define BROWN  "\033[33m"  // Amarelo escuro, aproximado do marrom
#define RESET  "\033[0m"
#define CYAN "\x1b[36m"
#define MAGENTA "\x1b[95m"

//Cores do menu

#define branco "\033[0m"
#define amarelo "\033[33m"

char tutoras[ALTURA1][LARGURA1] = {
    {'*','*','*','*','*','*','*','*','*','*'},
    {'*','.','.','*','X','V','*','.','*','D'},
    {'*','.','P','*','*','*','*','.','*','*'},
    {'*','.','.','*','.','.','.','.','.','*'},
    {'*','.','.','.','.','*','*','.','.','*'},
    {'*','.','.','*','*','*','.','.','.','*'},
    {'*','*','*','*','>','.','.','*','*','*'},
    {'*','.','.','.','.','.','*','*','O','*'},
    {'*','@','.','.','.','.','*','>','.','*'},
    {'*','*','*','*','*','*','*','*','*','*'}
}; //Matriz do tutoras

char vila[ALTURA1][LARGURA1] = {
        {'*','*','*','*','*','*','*','*','*','*'},
        {'*','.','.','.','.','.','.','.','P','*'},
        {'*','.','[','-','-','-','-',']','.','*'},
        {'*','.','|','~','~','~','~','|','.','D'},
        {'*','.','|','~','@','@','~','|','.','*'},
        {'*','.','|','~','@','@','~','|','.','*'},
        {'*','.','|','~','~','.~','~','|','.','*'},
        {'*','.','[','-','-','-','-',']','.','*'},
        {'*','@','.','.','.','.','.','.','.','*'},
        {'*','*','*','*','*','*','*','*','*','*'}
    };


char mapa1[ALTURA3][LARGURA3] = {
    {'*','*','*','*','*','*','*','*','*','*'},
    {'*','.','.','*','>','.','.','.','#','D'},
    {'*','.','.','*','.','.','.','.','#','*'},
    {'*','.','.','*','.','.','.','.','.','*'},
    {'*','.','.','.','.','*','*','.','.','*'},
    {'*','.','.','*','*','*','.','.','.','*'},
    {'*','*','*','*','.','.','.','*','*','*'},
    {'*','.','.','.','.','.','*','*','O','*'},
    {'*','@','.','.','.','.','*','>','.','*'},
    {'*','*','*','*','*','*','*','*','*','*'}
}; //Matriz do mapa da fase 1

char mapa2[ALTURA2][LARGURA2]={
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','.','.','.','#','#','#','.','.','.','.','#','#','#','>','.','.','.','.','#'},
    {'#','.','.','.','#','#','#','.','#','#','.','.','.','.','#','#','#','.','.','#'},
    {'#','.','.','.','#','#','#','.','.','#','.','.','.','.','.','.','#','.','.','#'},
    {'#','#','.','.','.','.','.','.','#','#','#','#','#','.','.','.','#','#','#','#'},
    {'#','#','#','#','#','#','#','.','.','.','.','#','#','#','#','#','#','#','#','#'},
    {'#','.','.','.','.','.','#','#','#','.','.','.','.','#','.','.','.','.','.','#'},
    {'D','.','#','#','#','.','.','.','#','.','#','#','.','.','.','#','#','#','.','#'},
    {'#','.','.','.','#','#','#','#','#','.','#','#','#','.','.','.','#','.','.','#'},
    {'#','#','.','.','.','.','.','.','.','.','.','#','#','#','#','.','.','#','#','#'},
    {'#','#','#','#','#','#','#','#','#','.','.','.','.','.','#','.','.','.','O','#'},
    {'#','.','.','.','.','.','.','.','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','#','#','#','#','#','#','.','.','.','.','.','.','#','#','O','.','.','.','#'},
    {'#','.','.','.','.','#','#','#','#','.','.','.','.','.','#','#','#','#','.','#'},
    {'#','.','#','#','.','.','.','#','.','#','#','#','#','#','#','#','.','.','.','#'},
    {'#','.','.','#','.','.','.','.','.','.','.','.','.','.','.','.','.','.','.','#'},
    {'#','#','.','#','#','#','#','.','.','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','.','.','.','.','>','#','.','.','.','.','.','.','#','.','.','.','.','@','#'},
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'}
};
char mapa3[ALTURA3][LARGURA3] = 
    		{"****************************************",
 			 "*......................................*",
 			 "*...............***....................*",
 			 "************...*****...************###.*",
 			 "*************.*******.*************....*",
 			 "***********************************.##.*",
 			 "***...........*******...........***....*",
 			 "**...#.........*****..........#..**#.##*",
 			 "*......#........***.........#...#.*....*",
 			 "*......*##...............##...###.*###.*",
 			 "**..@.*#####################...#..*....*",
 			 "***..**###.......###########.#.##.*.###*",
 			 "******##...#####..#######...##....*....*",
 			 "***###....#######..#####......##.**##.#*",
 			 "****>....#########...............***...*",
 			 "***********************************.#.#*",
 			 "***********************************....*",
 			 "*********...................*******#.#.*",
 			 "*******................................*",
 			 "******........******..........#########*",
 			 "*****......************........########*",
 			 "****......******....****........#######*",
 			 "***......*****.......****........######*",
 			 "**......*****.........****........#####*",
 			 "*......*****......********.........####*",
 			 "*.....*****......**********.......**###*",
 			 "*....*****......**....*****......****##*",
 			 "*.....*****....**..D...***......*****##*",
 			 "*......*****...***...****......******##*",
 			 "*..##...*****...********......*******##*",
 			 "*........******................******##*",
 			 "*....##....*****................*****##*",
 			 "*........#.***********...........****##*",
 			 "*....##......***********..........**###*",
 			 "*..#.......#..***********....>.....####*",
 			 "*.....###........**********.......#####*",
 			 "*.#....O...#.#.....*********.....######*",
 			 "*....#....#....##...**********..#######*",
 			 "*......##.............*********########*",
			 "****************************************"};
    //Mapas originais para resetar o game
    char mapa1_reset[ALTURA1][LARGURA1] = {
    {'*','*','*','*','*','*','*','*','*','*'},
    {'*','.','.','*','>','.','.','.','#','D'},
    {'*','.','.','*','.','.','.','.','#','*'},
    {'*','.','.','*','.','.','.','.','.','*'},
    {'*','.','.','.','.','*','*','.','.','*'},
    {'*','.','.','*','*','*','.','.','.','*'},
    {'*','*','*','*','.','.','.','*','*','*'},
    {'*','.','.','.','.','.','*','*','O','*'},
    {'*','@','.','.','.','.','*','>','.','*'},
    {'*','*','*','*','*','*','*','*','*','*'}
};
char mapa2_reset[ALTURA2][LARGURA2]={
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','.','.','.','#','#','#','.','.','.','.','#','#','#','>','.','.','.','.','#'},
    {'#','.','.','.','#','#','#','.','#','#','.','.','.','.','#','#','#','.','.','#'},
    {'#','.','.','.','#','#','#','.','.','#','.','.','.','.','.','.','#','.','.','#'},
    {'#','#','.','.','.','.','.','.','#','#','#','#','#','.','.','.','#','#','#','#'},
    {'#','#','#','#','#','#','#','.','.','.','.','#','#','#','#','#','#','#','#','#'},
    {'#','.','.','.','.','.','#','#','#','.','.','.','.','#','.','.','.','.','.','#'},
    {'D','.','#','#','#','.','.','.','#','.','#','#','.','.','.','#','#','#','.','#'},
    {'#','.','.','.','#','#','#','#','#','.','#','#','#','.','.','.','#','.','.','#'},
    {'#','#','.','.','.','.','.','.','.','.','.','#','#','#','#','.','.','#','#','#'},
    {'#','#','#','#','#','#','#','#','#','.','.','.','.','.','#','.','.','.','O','#'},
    {'#','.','.','.','.','.','.','.','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','#','#','#','#','#','#','.','.','.','.','.','.','#','#','O','.','.','.','#'},
    {'#','.','.','.','.','#','#','#','#','.','.','.','.','.','#','#','#','#','.','#'},
    {'#','.','#','#','.','.','.','#','.','#','#','#','#','#','#','#','.','.','.','#'},
    {'#','.','.','#','.','.','.','.','.','.','.','.','.','.','.','.','.','.','.','#'},
    {'#','#','.','#','#','#','#','.','.','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','.','.','.','.','>','#','.','.','.','.','.','.','#','.','.','.','.','@','#'},
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'}
};
char mapa3_reset[ALTURA3][LARGURA3] = 
    		{"****************************************",
 			 "*......................................*",
 			 "*...............***....................*",
 			 "************...*****...************###.*",
 			 "*************.*******.*************....*",
 			 "***********************************.##.*",
 			 "***...........*******...........***....*",
 			 "**...#.........*****..........#..**#.##*",
 			 "*......#........***.........#...#.*....*",
 			 "*......*##...............##...###.*###.*",
 			 "**..@.*#####################...#..*....*",
 			 "***..**###.......###########.#.##.*.###*",
 			 "******##...#####..#######...##....*....*",
 			 "***###....#######..#####......##.**##.#*",
 			 "****>....#########...............***...*",
 			 "***********************************.#.#*",
 			 "***********************************....*",
 			 "*********...................*******#.#.*",
 			 "*******................................*",
 			 "******........******..........#########*",
 			 "*****......************........########*",
 			 "****......******....****........#######*",
 			 "***......*****.......****........######*",
 			 "**......*****.........****........#####*",
 			 "*......*****......********.........####*",
 			 "*.....*****......**********.......**###*",
 			 "*....*****......**....*****......****##*",
 			 "*.....*****....**..D...***......*****##*",
 			 "*......*****...***...****......******##*",
 			 "*..##...*****...********......*******##*",
 			 "*........******................******##*",
 			 "*....##....*****................*****##*",
 			 "*........#.***********...........****##*",
 			 "*....##......***********..........**###*",
 			 "*..#.......#..***********....>.....####*",
 			 "*.....###........**********.......#####*",
 			 "*.#....O...#.#.....*********.....######*",
 			 "*....#....#....##...**********..#######*",
 			 "*......##.............*********########*",
			 "****************************************"};

//Matrizes para cutscenes

char entrada_bosque[25][80]={
    "%%%%%%#########%#################################%%#############%%%%*+++++",
    "%%%%%##########%######%#####%%########%%#########%%##########%%%%%%#++++++",
    "%%%%%%%%%%%%%%%%%####%%#####%%########%%######%###%#########%%%%%%#+++++++",
    "%%%%%######%%%%%%####%%######%#######%%%###################%%%%%%#++++++++",
    "%%%%%#######%################%########%%##################%%%%%%##++++++++",
    "%#%%%#######%###########################################%%%%%%%#+#++++++++",
    "%#%%%#######################*#############################%%%%#+++#+#+++##",
    "##%%%######%######******##********###**##################%%%##+++++#+++##+",
    "##%%%######%%##*******###******###*******#############%#%%%##+++++#++++##*",
    "##%%%##%%%%%##*******##******###**********#############%%%%##++++#++++####",
    "##%%%%%%%%%#*##****###******###****###****#########%%%%%%%%#++++#++++#####",
    "%%%%%%%%####**###****##***###***###**##****#######%%%%%%%%%++++#++++++++##",
    "%%%%%%%%##*****###****##----**###*****##***######%%%##%%%%#++++#+++++#####",
    "%%%%%%%###******###***--@@@@--*********##**######%%##%%%%%#++#++++#######*",
    "%%%%%%######*****###**---@@@@--###******####**###%##%%%%%%#+#+++######+++#",
    "%%%%%%%%##*###*****##*---@@@@@---###*******##*####%%%%%%%###+++##+++++++++",
    "####%%%%#****###****###---@@@---**###********###%#%%%%%%%###++###+++++++++",
    "#####%%###*****###*******-----*****###*******##%%#%##%%%%###++####+++++++=",
    "#####%%####******##**######*******#####*****###%%###%%%%%#######++++++++==",
    "%####%%%%###*******###*###************##**####%%%###%%%%%####++++++++++===",
    "%####%%%%%###************###***********##*####%%%###%%%%#####+++++++++====",
    "%%%###%%%%#####************###**********#####%%%######%%###+++++++++++====",
    "%%%##%%%%%%%######***********###*******####%%%%#######%%####++++++++++====",
    "%%%%%%%%%%%%%%%#######*********###*****##%%%%#########%####++++++++++=====",
    "%%%%%%%#%%###%%%%%######################%%%%#########%%####++++++++++====="
};

char entrada_bosque2[20][66]={
    "%%%%%#######%################%########%%##################%%%%%%#",
    "%#%%%#######%###########################################%%%%%%%#+",
    "%#%%%####################****#############################%%%%#++",
    "##%%%######%######*##************##****##################%%%##+++",
    "##%%%######%%##**###***********###*******#############%#%%%##++++",
    "##%%%##%%%%%##**###**********###**********#############%%%%##++++",
    "##%%%%%%%%%#******###*******##************#########%%%%%%%%#++++#",
    "%%%%%%%%####*******###*****##**************#######%%%%%%%%%++++#+",
    "%%%%%%%%##***********###----********###****######%%%##%%%%#++++#+",
    "%%%%%%%###***********---@@@@---***###*###**######%%##%%%%%#++#+++",
    "%%%%%%####********###---@@@@----*###***###*#**###%##%%%%%%#+#+++#",
    "%%%%%%%%##******###***---@@@@--###*******##***####%%%%%%%###+++#*",
    "####%%%%#******###*****--@@@@@--*********###**##%#%%%%%%%###++##*",
    "######%%###**###*******###-----###*********####%%#%##%%%%###++###",
    "#####%%######********###*******###**********###%%###%%%%%#######+",
    "#####%%%%###*******###***********###******####%%%###%%%%%####++++",
    "%####%%%%%###*******###***********###*****####%%%###%%%%#####++++",
    "%%%###%%%%#####*******###***********###*#####%%%######%%###++++++",
    "%%%%#%%%%%%%######******###***********#####%%%%#######%%####+++++",
    "%%%%%%%%%%%%%%%#######****###**********##%%%%#########%####++++++",
};
char entrada_bosque3[15][57]={
    "##%%%######%######*##************##****#################",
    "##%%%######%%##**###***********###*******#############%#",
    "##%%%##%%%%%##**###**********###**********#############%",
    "##%%%%%%%%%#******###*******##************#########%%%%%",
    "%%%%%%%%####*******###*****##**************#######%%%%%%",
    "%%%%%%%%##***********###----********###****######%%%##%%",
    "%%%%%%%###***********---@@@@---***###*###**######%%##%%#",
    "%%%%%%####********###---@@@@----*###***###*#**###%##%%%%",
    "%%%%%%%%##******###***---@@@@--###*******##***####%%%%%%",
    "####%%%%#******###*****--@@@@@--*********###**##%#%%%%%%",
    "######%%###**###*******###-----###*********####%%#%##%%%",
    "#####%%######********###*******###**********###%%###%%%%",
    "#####%%%%###*******###***********###******####%%%###%%%%",
    "%####%%%%%###*******###***********###*****####%%%###%%%%",
    "%%%###%%%%#####*******###***********###*#####%%%######%%",
};
char entrada_bosque4[12][57]={
    "**###**********###**********#############%",
    "%%%%%#******###*******##************######",
    "%%####*******###*****##**************#####",
    "#%%##***********###----********###****####",
    "%###***********---@@@@---***###*###**#####",
    "%###********###---@@@@----*###***###*#**##",
    "%###******###***---@@@@--###*******##***##",
    "###******###*****--@@@@@--*********###**##",
    "#####**###*******###-----###*********####%",
    "#####%%********###*******###**********###%",
    "#####%%%*******###***********###******####",
    "%####%%%%%*******###***********###*****###"
};
char entrada_bosque5[6][23]={
    "%%##***********###---",
    "%#***---@@@@---***###",
    "%*###---@@@@----*###*",
    "*##***---@@@@--###***",
    "##*****--@@@@@--*****",
    "###**###*******###--",
    
};
void cuts_bosque(){
    int i, j;
    char introducao[5][230]={
        {"E assim tem inicio nossa historia, protagonizada por um nobre aventureiro... Um destemido explorador que ouvira rumores acerca de antigas catacumbas ocultas nas profundezas do Bosque Proibido...\0"},
        {"Tais catacumbas, no entanto, jamais foram localizadas, meros sussurros do vento, dizem alguns... Mas nada disso abalava a conviccao de nosso heroi, que nutria uma fe inabalavel na existencia daquele bosque enigmatico.\0"},
        {"Contudo, apos tantas jornadas infrutiferas, seu corpo comecava a ceder aos sinais do cansaco. O bosque, denso e perpetuamente mergulhado em sombras, testava sua resistencia a cada passo.\0"},
        {"Foi entao, no exato instante em que cogitava abandonar a busca e enfrentar o arduo retorno ao lar... que avistou uma luz. Uma tenue e misteriosa luz emanando do interior de uma arvore.\0"},
        {"Um sorriso espontaneo tomou seu rosto, ele sabia que estivera certo em persistir. Algo naquela luz o chamava, irresistivelmente. E, ao decidir aproximar-se... o heroi foi subitamente tragado pela propria arvore.\0"}
    };
    printf("\n<------------------------------------------------------------------------========------------------------------------------------------------------------------->\n");
    for(i=0;introducao[i]!= '\0';i++)
    {
        for(j=0; introducao[i][j] != '\0'; j++)
        {
            
            printf(YELLOW"%c"RESET, introducao[i][j]);RESET; // Reseta a cor do texto
            Sleep(40); // Pausa para dar efeito de animação
            if(kbhit()) { // Verifica se uma tecla foi pressionada
            getch(); // Lê a tecla pressionada
            break; // Interrompe o loop se uma tecla for pressionada
        }
        }
        printf("\n"); // Nova linha após cada frase
        Sleep(30);
    
        if(i==4){
            break;
        }
    }
    printf("\n<------------------------------------------------------------------------========------------------------------------------------------------------------------->\n");
    Sleep(2000);
    system("cls"); // Limpa a tela após a introdução
    // Exibe a primeira parte da cutscene
for (i = 0; i < 25; i++) { // entrada_bosque: 25x80
    for (j = 0; j < 80; j++) {
        if (entrada_bosque[i][j]=='%' || entrada_bosque[i][j]=='#')
            printf(BROWN"%c" RESET, entrada_bosque[i][j]);
        else if (entrada_bosque[i][j]=='*')
            printf(BLACK "%c" RESET, entrada_bosque[i][j]);
        else if (entrada_bosque[i][j]=='@')
            printf(WHITE "%c" RESET, entrada_bosque[i][j]);
        else if(entrada_bosque[i][j]=='=' || entrada_bosque[i][j]=='+' || entrada_bosque[i][j]=='-')
            printf(GREEN "%c" RESET, entrada_bosque[i][j]);
        else
            printf("%c", entrada_bosque[i][j]);
    }
    printf("\n");
}
Sleep(500);
system("cls");

// Exibe a segunda parte da cutscene
for (i = 0; i < 20; i++) { // entrada_bosque2: 20x66
    for (j = 0; j < 66; j++) {
        if (entrada_bosque2[i][j]=='%' || entrada_bosque2[i][j]=='#')
            printf(BROWN"%c" RESET, entrada_bosque2[i][j]);
        else if (entrada_bosque2[i][j]=='*')
            printf(BLACK "%c" RESET, entrada_bosque2[i][j]);
        else if (entrada_bosque2[i][j]=='@')
            printf(WHITE "%c" RESET, entrada_bosque2[i][j]);
        else if(entrada_bosque2[i][j]=='=' || entrada_bosque2[i][j]=='+' || entrada_bosque2[i][j]=='-')
            printf(GREEN "%c" RESET, entrada_bosque2[i][j]);
        else
            printf("%c", entrada_bosque2[i][j]);
    }
    printf("\n");
}
Sleep(700);
system("cls");

// Exibe a terceira parte da cutscene
for (i = 0; i < 15; i++) { // entrada_bosque3: 15x57
    for (j = 0; j < 57; j++) {
        if (entrada_bosque3[i][j]=='%' || entrada_bosque3[i][j]=='#')
            printf(BROWN"%c" RESET, entrada_bosque3[i][j]);
        else if (entrada_bosque3[i][j]=='*')
            printf(BLACK "%c" RESET, entrada_bosque3[i][j]);
        else if (entrada_bosque3[i][j]=='@')
            printf(WHITE "%c" RESET, entrada_bosque3[i][j]);
        else if(entrada_bosque3[i][j]=='=' || entrada_bosque3[i][j]=='+' || entrada_bosque3[i][j]=='-')
            printf(GREEN "%c" RESET, entrada_bosque3[i][j]);
        else
            printf("%c", entrada_bosque3[i][j]);
    }
    printf("\n");
}
Sleep(700);
system("cls");

// Exibe a quarta parte da cutscene
for (i = 0; i < 12; i++) { // entrada_bosque4: 12x57
    for (j = 0; j < 57; j++) {
        if (entrada_bosque4[i][j]=='%' || entrada_bosque4[i][j]=='#')
            printf(BROWN"%c" RESET, entrada_bosque4[i][j]);
        else if (entrada_bosque4[i][j]=='*')
            printf(BLACK "%c" RESET, entrada_bosque4[i][j]);
        else if (entrada_bosque4[i][j]=='@')
            printf(WHITE "%c" RESET, entrada_bosque4[i][j]);
        else if(entrada_bosque4[i][j]=='=' || entrada_bosque4[i][j]=='+' || entrada_bosque4[i][j]=='-')
            printf(GREEN "%c" RESET, entrada_bosque4[i][j]);
        else
            printf("%c", entrada_bosque4[i][j]);
    }
    printf("\n");
}
Sleep(700);
system("cls");

// Exibe a quinta parte da cutscene
for (i = 0; i < 6; i++) { // entrada_bosque5: 6x23
    for (j = 0; j < 23; j++) {
        if (entrada_bosque5[i][j]=='%' || entrada_bosque5[i][j]=='#')
            printf(BROWN"%c" RESET, entrada_bosque5[i][j]);
        else if (entrada_bosque5[i][j]=='*')
            printf(BLACK "%c" RESET, entrada_bosque5[i][j]);
        else if (entrada_bosque5[i][j]=='@')
            printf(WHITE "%c" RESET, entrada_bosque5[i][j]);
        else if(entrada_bosque5[i][j]=='=' || entrada_bosque5[i][j]=='+' || entrada_bosque5[i][j]=='-')
            printf(GREEN "%c" RESET, entrada_bosque5[i][j]);
        else
            printf("%c", entrada_bosque5[i][j]);
    }
    printf("\n");
}
Sleep(700);
system("cls");
}


// Marrom (Brown)
void cor_marrom() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 6); // 6 = marrom (yellow + red)
}

void cor_ciano() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 11); // 11 = cyan (blue + green + intensity)
}

// Amarelo escuro (Dark Yellow)
void cor_amarelo_escuro() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 14); // 14 = yellow (mais escuro que o branco)
}

// Roxo (Purple)
void cor_roxo() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 5); // 5 = purple (red + blue)
}


// Amarelo claro (Bright Yellow)
void cor_amarelo_claro() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 15); // 15 = branco, mas em muitos consoles aparece como amarelo claro
}

// Vermelho escuro (Dark Red)
void cor_vermelho_escuro() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 4); // 4 = dark red
}

// Resetar cor (padrão do console)
void cor_resetar() {
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 7); // 7 = cinza claro padrão
}
    
void RENICIARMAPA1() {
    // Função para reiniciar o mapa 1
    for (int i = 0; i < ALTURA1; i++) {
        for (int j = 0; j < LARGURA1; j++) {
            mapa1[i][j] = mapa1_reset[i][j];
        }
    }
}
void RENICIARMAPA2() {
    // Função para reiniciar o mapa 2
    for (int i = 0; i < ALTURA2; i++) {
        for (int j = 0; j < LARGURA2; j++) {
            mapa2[i][j] = mapa2_reset[i][j];
        }
    }
}
void RENICIARMAPA3() {
    // Função para reiniciar o mapa 3
    for (int i = 0; i < ALTURA3; i++) {
        for (int j = 0; j < LARGURA3; j++) {
            mapa3[i][j] = mapa3_reset[i][j];
        }
    }
}

//função pro tutoras
void INICIAR_TUTORAS() {
    for (int i = 0; i < ALTURA1; i++) {
        for (int j = 0; j < LARGURA1; j++) {
            mapa1[i][j] = tutoras[i][j];
        }
    }
}
void INICIAR_VILA() {
    for (int i = 0; i < ALTURA1; i++) {
        for (int j = 0; j < LARGURA1; j++) {
            mapa1[i][j] = vila[i][j];
        }
    }
}
// Função para iniciar o mapa
void iniciarMapa(int fase) {
    int i,j;
    if(fase<=3){//Fase 1, vila e tutorial
        for (i = 0; i < 10; i++) {
            for (j = 0; j < 10; j++) {
                if(mapa1[i][j] == '.') {
                    cor_marrom(); // Cor marrom para o chão
                }
                if(mapa1[i][j] == '*' || mapa1[i][j] == '#') {
                    cor_amarelo_escuro(); // Cor amarela escura para a parede ou espinhos
                }
                if (mapa1[i][j] == 'D') {
                    cor_roxo(); // Cor roxa para a porta
                }
                if (mapa1[i][j] == 'P' || mapa1[i][j]=='@' || mapa1[i][j]=='O' || mapa1[i][j]=='>') {
                    cor_amarelo_claro(); // Cor amarela
                }
                if(mapa1[i][j] == 'V' || mapa1[i][j] == 'X') {
                    cor_vermelho_escuro(); // Cor vermelha escura para o NPC
                }
                if(mapa1[i][j] == '~') {
                    cor_ciano();
                }
                printf(" %c ", mapa1[i][j]);
                cor_resetar(); // Reseta a cor para o padrão do console
            }
            printf("\n");
        }
    } else if(fase==4){//fase2
        
        for (i = 0; i < 20; i++) {
            for (j = 0; j < 20; j++) {
                if(mapa1[i][j] == '.') {
                    cor_marrom(); // Cor marrom para o chão
                }
                if(mapa1[i][j] == '*' || mapa1[i][j] == '#') {
                    cor_amarelo_escuro(); // Cor amarela escura para a parede ou espinhos
                }
                if (mapa1[i][j] == 'D') {
                    cor_roxo(); // Cor roxa para a porta
                }
                if (mapa1[i][j] == 'P' || mapa1[i][j]=='@' || mapa1[i][j]=='O' || mapa1[i][j]=='>') {
                    cor_amarelo_claro(); // Cor amarela clara para o NPC
                }
                if(mapa1[i][j] == 'V' || mapa1[i][j] == 'X') {
                    cor_vermelho_escuro(); // Cor vermelha escura para o NPC
                }
                printf(" %c ", mapa1[i][j]);
                cor_resetar(); // Reseta a cor para o padrão do console
            }
            printf("\n");
        }
    } else if(fase==5){//fase3
        for (i = 0; i < 40; i++) {
            for (j = 0; j < 41; j++) {
                if(mapa1[i][j] == '.') {
                    cor_marrom(); // Cor marrom para o chão
                    printf(" %c ", mapa1[i][j]);
                    cor_resetar(); // Reseta a cor para o padrão do console
                }
                if(mapa1[i][j] == '*' || mapa1[i][j] == '#') {
                    cor_amarelo_escuro(); // Cor amarela escura para a parede ou espinhos
                    printf(" %c ", mapa1[i][j]);
                    cor_resetar(); // Reseta a cor para o padrão do console
                }
                if (mapa1[i][j] == 'D') {
                    cor_roxo(); // Cor roxa para a porta
                    printf(" %c ", mapa1[i][j]);
                    cor_resetar(); // Reseta a cor para o padrão do console
                }
                if (mapa1[i][j] == 'P' || mapa1[i][j]=='@' || mapa1[i][j]=='O' || mapa1[i][j]=='>') {
                    cor_amarelo_claro(); // Cor amarela clara para o NPC
                    printf(" %c ", mapa1[i][j]);
                    cor_resetar(); // Reseta a cor para o padrão do console
                }
                if(mapa1[i][j] == 'V' || mapa1[i][j] == 'X') {
                    cor_vermelho_escuro(); // Cor vermelha escura para o NPC
                    printf(" %c ", mapa1[i][j]);
                    cor_resetar(); // Reseta a cor para o padrão do console
                }
            }
            printf("\n");
        }
    }
}

// Função para iniciar o mapa 2
void iniciarMapa2() {
    for (int i = 0; i < ALTURA2; i++) {
        for (int j = 0; j < LARGURA2; j++) {
            mapa1[i][j]=mapa2[i][j]; // Copia o mapa 2 para o mapa 1
        }
        printf("\n");
    }
    
}

// Função para iniciar o mapa 3
void iniciarMapa3() {
    for (int i = 0; i < ALTURA3; i++) {
        for (int j = 0; j < LARGURA3; j++) {
            mapa1[i][j]=mapa3[i][j]; // Copia o mapa 3 para o mapa 1
        }
        printf("\n");
    }
}

// Função para mover o player
void moveplayer(int *y, int *x, char *dire, int *chavecoletada, int *cimachave, int *vida, int *frenteporta, int *fase, int *cimaBotao, int *frenteNPC) {
    int novax = *x, novay = *y;
    static int cimaTP= 0; // Variável estática para verificar se o player está em cima do TP
    switch (*dire) {
        case 'w': novay = *y - 1; break;//cima
        case 's': novay = *y + 1; break;//baixo
        case 'd': novax = *x + 1; break;//direita
        case 'a': novax = *x - 1; break;//esquerda
        default: break;
    }
        // Verifica se o novo movimento é válido ou se a realidade não é apenas uma simulação criada pelas grandes empresas para fazer uma pesquisa de mercado
        if (mapa1[novay][novax] == '.' || mapa1[novay][novax] == '@' || mapa1[novay][novax] == 'O' || mapa1[novay][novax] == '>') {
            //O bgl do TP lá. ACABA PELO O AMOR DE DEEEEEEEEEEEEEEEUS AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
            if (mapa1[novay][novax] == '>') {
                // Devolve o que estava na posição anterior do player (eu te odeio teletransporte... eu te odeio)
                if (*cimachave == 1) {
                    mapa1[*y][*x] = '@';
                    *cimachave = 0;
                } else if (*cimaBotao == 1) {
                    mapa1[*y][*x] = 'O';
                    *cimaBotao = 0;
                } else if (cimaTP == 1) {
                    mapa1[*y][*x] = '>';
                    cimaTP = 0;
                } else {
                    mapa1[*y][*x] = '.';
                }
                // Procura o outro TP diferente do atual
                for (int i = 0; i < ALTURA3; i++) {
                    for (int j = 0; j < LARGURA3; j++) {
                        if (mapa1[i][j] == '>' && (i != novay || j != novax)) {
                            *y = i; 
                            *x = j;//Os ponteiros do player mudam pra a outra posição
                            novax=*x;
                            novay=*y;
                            mapa1[novay][novax] = '&';
                            cimaTP = 1;
                            return; // Sai da função para não executar o resto do movimento e quebrar essa porcaria mais uma vez
                        }
                    }
                }
             }
            //Não faça mais merda nesse código por favor eu não aguento mais corrigir coisas nessa desgraça, Aiam. ASS: Aiam
            // Se estava em cima da chave, devolve a chave ao local anterior
            if (*cimachave == 1) {
                mapa1[*y][*x] = '@';
                *cimachave = 0;
            } else if (*cimaBotao == 1) {//Se estiver em cima do botão ele volta de ladinho
                mapa1[*y][*x] = 'O';
                *cimaBotao = 0;
            } else if(cimaTP == 1){//Se estiver em cima dessa merda de teletransporte
                mapa1[*y][*x] = '>';
                cimaTP = 0;
            } else {
                mapa1[*y][*x] = '.';
            }
            // Se vai pisar na chave, marca que está em cima dela
            if (mapa1[novay][novax] == '@') {
                *cimachave = 1;
            }
            // Se vai pisar no botão, marca que está em cima dele
            if (mapa1[novay][novax] == 'O') {
                *cimaBotao = 1;
            }
            
            mapa1[novay][novax] = '&';
            *y = novay;
            *x = novax;
            // Verifica se está em frente à porta
            if ((mapa1[novay+1][novax]=='D' ||    mapa1[novay-1][novax]=='D' ||
                mapa1[novay][novax+1]=='D' ||  mapa1[novay][novax-1]=='D')) {
                *frenteporta = 1;
            }else{
                *frenteporta = 0; // Reseta a porta em frente ao player
            }

            // Verifica se está em frente à porta aberta para mudar de fase
            if ((mapa1[novay+1][novax]=='=' ||    mapa1[novay-1][novax]=='=' ||
                mapa1[novay][novax+1]=='=' ||  mapa1[novay][novax-1]=='=')) {
                *fase += 1;
            }
            if (mapa1[novay+1][novax]=='P' ||    mapa1[novay-1][novax]=='P' ||
                mapa1[novay][novax+1]=='P' ||  mapa1[novay][novax-1]=='P') {
                *frenteNPC = 1;
                //Verificar se o player está em frente a um NPC
            }else{
                *frenteNPC = 0; // Reseta o NPC em frente ao player
            }
        } else if (mapa1[novay][novax] == 'X'|| mapa1[novay][novax]=='#' || mapa1[novay][novax]== 'V') { //Se o player encostar em algo periculoso, malvado e assanhado
            if(*vida==0){
            	system("cls");


puts("================-==----:-..::.:.........................................:..:.::------===============");
puts("===============------:::......................:::::::::::.....................-:-:-------===========");
puts("==============-----:::::...................-*+=========****+...............:....::--------==========");
puts("=============----:::::.................::+*=:-**%@@@@@%**+==##=..................::::::--=-=========");
puts("===========----:-::..................-+.:=%@@@@@@@@@@@@@@@@@+++*#=.................:::-------=======");
puts("==========-=---::::................-+-.-##@@@@@@@@@@@@@@@@@@@@%#*+*-................:::::---========");
puts("==========---:-:::................-+===.+%@@@@@@@@@@@@@@@@@@@@@@@#+*+:................:::----=======");
puts("========-------:.................+*::*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+*-.................::------=====");
puts("========------::................*=.=#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#+#:................:::-----=-===");
puts("=======------::::...............*=-#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+#:..................::--=--====");
puts("=====-------::::..............:%--#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@.................:::-------=");
puts("=====------::.................:%--#@@@@%*****#@@@@%*#@@%*****#%@@@@@%*%@.................::::------=");
puts("======-----::.................:%--#@@@@#.+##*:+%@@%:=%@#.=#%#--%@@@@%*%@...................:--:---==");
puts("====---=--:-::................:%--#@@@@#:+%@@%.=%@%:=@@#.=%@@%--#@@@%*%@.................::::------=");
puts("====-=----:::.................:%--#@@@@#:+%@@%.=%@%:=@@#.+%@@%--#@@@%*%@...................::-----==");
puts("=====-----:::.................:%--#@@@@#:+%@#-:=%@%:=@@#.=%@@-:#@@@@%*%@...................::------=");
puts("====--=---:-::................:%--#@@#:.....:*@@@@%:=@@#.....+%@@@@@%*%@...................:::----==");
puts("====------::::................:%-:#@@@@#:==-*%@@@@%:=@@#.+%@@@@@@@@@%*%@.................:::::-----=");
puts("=====-----::::................:%--#@@@@#:+%=:-#%@@%:=@@#.+%@@@@@@@@@%*%@................:::::---=--=");
puts("=====------::.................:%--#@@@@#.+%@#:=#@@%:=@@#.=%@@@@@@@@@%*%@................::::-------=");
puts("=======---:-:::...............:%--#@@@@#.+%@%*.=%@%:=@@#.=%@@@@@@@@@%*%@................:::::---====");
puts("=======------.................:%-:#@@@@%=*%@@%-*%@%=*@@#=*%@@@@@@@@@%*%@................:::-------==");
puts("========----:::...............:%--#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@................:::------===");
puts("========--=:-::...............:%--#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@................::::--======");
puts(":-=======-----::..............:%--=+#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@...............:::-----=====");
puts("-:-=======-----:..............:%--+*#*+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@..............:------=====:.");
puts("=---::====:--:----::........::=%--+%%%@@@@@@@@@@@@@@@@@%@@@@@+#@@@@@%*%@:::.........::-----===---..:");
puts("=--:-=+%***#*=-=+--::....:****%@--+%%+*@@@%=%+*%@@@@@@@#%=%@=%##@@@@%*%@@@%*=.....::--=+=#+=*#=:-===");
puts("==+*++##-%@@#**--=-=-+===++:--..........-=-...========-..=-...:=========-:-+%#====++++==*%@#%#-:==**");
puts("...............:........+*-%%%*#%%%%%%#%%%%%%%#%%%%%%%#%###*%%%%%%%#++#%#=*#*+......................");
puts("....................---.+*:*@%+*%@@*=%%@@@*=#@#%@@@@+*++*.+%@@@@@@@@@*:%@%%#**---=-.................");
puts(".:-.....................-=.--=:=++*=:++*+-+*==.=:+##=--=-####**+--##*=*#****++========-:::::::......");
puts("+#%#:....................................::..--:..:::..:...-...::::.::-::::.:::==-=------=------:...");
puts(".::-=-:........-----.........................:..:....::......:-..:-::.::..::::..:-.::...............");
puts("....................................................................................................");
puts("...........=.......=:**#*-.............................................................-......----:.");
puts("........:+-##=.......................................................:+**#+:........:.#+#=:......-=*");
puts(".......:#+%%@@:...................................................................%*#.%@@@=.........");
puts("...*##%%%%%%%%##+.........:-#-:*+#*-:..........................................*-##+##%%%%##=:......");
puts("..............:::===---:..-:.:...::-:.....................................................:::-=-----");
puts("....................................................................................................");
puts("......................--:---+*=-....................................................................");
puts("...............................:...............................................................:::::");
puts("........................................................................................::::........");
puts(".....:+###-:.............................................................::.:.......::*#-*##=::.....");

puts("");

                system("pause");
                system("cls");
                *vida=3; // reseta a vida
                *chavecoletada = 0; // Reseta a chave coletada
                mapa1[*y][*x] = '.'; // Corpo do player some antes de resetar
                *x = 1,*y=1; // Reseta a posição do player
                *fase=0; //volta pro menu
                return;
            } else{
            	if(mapa1[novay][novax] == 'V'){
            		system("cls");


puts(".............................+@@@@@@@@@@@@@@:*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@%@@@+---%@@@@%%:..");
puts("...........................:@@@@%%%%=...%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%#...:%%@@@=.");
puts(".........................:+@@%**.........-*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*==.........-@@=.");
puts(".........................+@@-:..@+........:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:+#......-@@=.");
puts(".........................*@@....@@*.......-@@%@@@@@@@@%+.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=::.......");
puts(".........................*%=....@@#+....-#@@*:@@@@@@@@:..+%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*-..+:.");
puts("................................:#@@%%%%@@@@*:@++@*.+@:=%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*.%@+");
puts("..................................-#@@@@@@@@@@@==@+.+@@@@@@#.#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+");
puts("....................................------=@@@@%@@@%@@@@@-*#.#@@@@@@@@@@@@@@@@@@@@@+*@@@@@@@@@@@@@@*");
puts("..........................................:@@@@%@@@@@@-=%.+#.#@@@@@@@@@@@@@@@@@@@@@==@:+%%@@@@@@@@@%");
puts("......................:*##+.***-..........:@@@@-*#+-:+*-.*%@*%@@@@@@@@@@@@@@@@@@@@@==@....-#@@@@@@@+");
puts(".....................*@@@+..@@@=.........:=@@@@@@#.#*.%@@@%%@@@@@@@@@@@@@@@@@@@@@@%-:=.:---*@@@@@@@+");
puts(".....................*@@@@%%@@@=........#%@@@@@@@%*%%*@@@=+%@@@@@@@@@@@@@@@@@@@@@%*:...+@@@@@@@@@@@+");
puts(".....................*@@@@@@@@=.....:%@@@@@@@@@@@@@@@@:...*@@@@@@@@@@@@@@@@@@@@@@#.....+@@@@@@@@@@@+");
puts(".....................*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@%-......-....#@@@@+");
puts(".....................-=+@@@@@@@@@@@@@@@@@@@@@@@@=:=...-=+@@@@@@@@@@@@@@@@@@@@@@@@@@%+....=:=##%@@@=.");
puts("........................:#@@@@@@@@@@@@@@@@@@@@@@=-+.....-@@@@@@@@@@@@@@@@@@@@@@@@@@@#.....#@@@@@@-..");
puts("............................#@@%#%@@@@@@@@@@@@......=#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#...:#####+.....");
puts(".............................+*..=%@@@+=+%@@@%..*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#...............");
puts("...................................=#@-...:@@%:%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%-%*=@..........");
puts(".........:*+========+*-..............-...==.%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#==..........");
puts("........+*:..........:#=.................#@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*...........");
puts(".....-%@#=.==.....@@@@@+..............#@:#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-.........");
puts(".......@@%+-:..-%@@=+@@+..............#@@@@@@@@@@@@@@@%%@@@@@@@@@@%@@-*@@%%@@@@@@@@@@@@@@@*-........");
puts(".........=@+--.-%:....#+............@@@@@@@@@@@@@@@@@@:=@@@@@@#-%#-@@-*%-.+@@@@@@@@@@@@@@@@=........");
puts(".........:===+##@%##*.-:............@@@@@@@@@@@@+.@%%@:=@.+#.##.%#=@@-*%..+%:#@@@@@@@@@@@@@@@@@#....");
puts("........+%%%+.::::::=%-...........:*@@@@@@@@@@*=-.@+:-...:*#.##.#@@@@-....-+:#@@#+@@@@@@@@@@@%+:....");
puts("........+@@-=@@@%%%@@@=..........-#@@@@@@@@@=--...@+.....%%*.....-@@#-......+%:#*:@@@@@@@@@@@@@*....");
puts("........+#.#@@@#:.:=#@=..........=@@@@@@@@@@:.....@+.............=@@.....-*%@+.*+:@==@@@@@@@@@@%=...");
puts(".....:+*%@#@#+*#@@@@@@@@@@@@%+...=@@@@@@.:##:.....................-@.......:%:......:--*@#@@@@@@@:..");
puts("......::*@@=::@@@@@@@@+::::::....@@@@@@@..........................-@................:+++=.#@@@@@@@=.");
puts(".......#####%@@@@@@@@@=........:-@@@@@@@..........................-%.......................+@@@@@@@+");
puts("...........#@@%+..@@%........-#@@@@@@@@@....................................................-@@@@@@%");
puts("..:::::#%%%@@@%%%%@@@%%%%%%%%@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@");
puts("..--------------------------------------------------------------------------------------------------");
puts("........=*****+****++++*++++++*+++**********++****+++++++*******+*********+*++**++***********++++**+");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("");
puts("ALGO TERRIVEL ACONTECEU");
puts("Ao adentrar o terceiro nIvel da masmorra,");
puts("nosso heroi deu de cara com um terrivel monstro que matou em uma mordida e lhe vomitou logo em seguida");
puts("Descanse em paz heroi,um pessimo sobrevivente e um pessimo almoco...");
puts("");
                system("pause");
                *vida-=1; // Perde uma vida
                *chavecoletada = 0; // Reseta a chave coletada
                mapa1[*y][*x] = '.'; // Corpo do player some antes de resetar
                *x = 1,*y=1; // Reseta a posição do player
                if(*fase==3){
                    RENICIARMAPA1(); // Reinicia o mapa 1
                    iniciarMapa(1); // Reinicia o mapa 1
                } else if(*fase==4){
                    RENICIARMAPA2(); // Reinicia o mapa 2
                    iniciarMapa2(); // Inicia o mapa 2
                } else if(*fase==5){
                    RENICIARMAPA3(); // Reinicia o mapa 3
                    iniciarMapa3(); // Inicia o mapa 3
					}
                }
                            	if(mapa1[novay][novax] == 'X'){
            		system("cls");




puts("..=%%-.-=+=+#%*-+++@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=.=*%%+:.--:-=...........................");
puts("...:*+*#-+++*##%%%%%@@@%@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@-==+:.=+=....:*@%:...................");
puts(".::..:*@%++-+@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%##=:+*:--..-::%@@#:..................");
puts(":.=#.=+=%%%=*@@@@@@@@%#%@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=:%@%%-::=+:=:..:......................");
puts("*:=*.=*#@@@@@@@@@@@@@@@@%%@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@*#===:.:+=*..::.....:............");
puts("=@@#-@*.+@@@%@@@%%@@@@@@@@@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@%:..-%%-.:=:...-#=+...........");
puts(".-%%++%%@%@@@@%%%@@@%@@@@@@@@@@@@@@@@@@@=@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@%#+%%-.:.=%@#*=:.............");
puts("-#-:*%#@@@%%##@@@@@@%@@@@@@@@@@@@%@@@@%.-@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@*-+@+:+@:.:+..#=.........");
puts("%@*=@@@@@@%%@@@@@%@@@@@@%%@@%@@@@%@@@@%.-%+=@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@%=.-#@+.:*+%%-.........");
puts("#=@@@@@@%%%%@@@%##@@%#%@@@@##@@@@%##@@@@#:=#+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@-+@@*............");
puts("@%@@@@@@@@@@@@@@@@@@@@@@@@%@@@%#%@@@@@@@#+*-*+@#+**@@+#=%@*==#@@@@@@@@@@@@@@@@@@%@#@@%=+............");
puts("@@@@#@@@@@@@@@@#=*@@@@@@@@@%%#%%%#%@@@@@@@%+++-.-++#-%=*:......-===*#%%%@@@@@@@@%%@@%=.:............");
puts("@@%#@@@@@@@@+..==*@@@@@@@@@@@@@%@@@@@@@@@@@#+*.+++++=:#-............:+*@@@@@@@@@@@@@@@#==:...:=.....");
puts("@@@%@@@@@#-..::.*%*#@@@@@@%%@@@@@@@@@@@@@%@@@@@#***%@@-..............:-=#@@@@@@@%@@@%@@#-*-.........");
puts("@%%@@#%@*:..=+:.:*%@@@@%@@@@##%##%@@@@@@@@@@**@@@@@@@-......=:........-*=+*%@@@@@@@@@@@@@=..........");
puts("@@%@@@%%*.--..:+#*-.#@@@@@@@@@@@@@@@@@@@@*-::::+%@@*:....................=:.-*###%@@@@@%%%##::=.....");
puts("@@@@@@%=..==...--=*%@@@@@@@@@@@@@@@@@@@@%+-....::=-..................-=......-@.:*%@@@@@%%*=:+......");
puts("@@@@@*+*......==.*@@@@@@@@@@@@@@@@@@@@@@@@%+.==.::....-:.............-=....-::+...::+@@@@@@@#--:....");
puts("@@@@%:::..::..+**@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@+.++.+-..................=:::......=@@@@@@@@@#%@+...");
puts("@@@@%:..---=::+**@@@@%%@@@%@@@@@@@@@@@@@@@@@@@@@@%@%--=-...........=:.............:@@@@@@@@@@@@@@*..");
puts("@@@@@%=.--....-=#@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+::.:........-:............:@@@%==*@@@@@@@@@*-");
puts("@@@@@@@@@@+....=%@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**-..:#:................:@@#....+@@@@%@@@@*");
puts("@@@@@@@@@@@@+..:+@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+:..+%:....=########@..:%@#...=%%=.%@@**@*");
puts("@@@%@@@#*@@@*.+*.#@@@%@@@@@@@@@@@@@@@@@@@%@@%####@@@@@%@@@@#:-=.....:%====....=*:..+*...+*:..:@@++@*");
puts("@@@@@=...-%@*...-%@@@@@@@@@@@@*:.....:=*@@@@@@@@@@@@@@@@%@@@%==-....:%-+#-%:..:%:............+@@=+*.");
puts("@@@@%:.-=:#%=..:#@%#@@@@@@@@#:..........-##%@@@@@@@@@@%####%@*=:....:%=---*:.:-%=========:...:@=.:..");
puts("@@@@%:...+=:.:+@@%#%@@@@@@@=................:::*@@@@@@=.:-#%@@%-.....=@%*+++#%%@@@@@#:-*%@-...:.....");
puts("@#+@@*:......*@@@@@@@@@@@@=................--.=*****#@@%::+-:#@-.......*@@*=-*..=@@@@%%%%@%-........");
puts("@%++@%=....=+*@@@@@@@@%%#-...-:...........:+***********#@#==+--**-=*:.=*%*=#%+..:#@@%=+=.+%-........");
puts("*@%++@@@#-..-%@@@@@@%%%+:..................-*************#%#*++:-#*@@**#%%++:..-=+@@%-:++.#-........");
puts(".-##+...::..+@@@@@@@@@++::::..:..-:.....:.:=***************++#**@@=%*#%+...::=@@%%@@@@@@@@#-........");
puts(".......=*::+@@@@@@@@=..::...=...=:......-************+--=:......-#+@#%%*#@@@%###%%%%%##+:...........");
puts("-+.:+:=+:+*#@@@@@@@+..=-::.......+:..:+****+*******+-.::=.......##=:.:*@%%@=:...:==+##:.............");
puts("....-*+@@@@@@@@@@@++=.=%-#-:@:......===******#****=:..:=:............=*....=#-.:=+@%+*@*............");
puts("=+-*.=@@@@@@%@@@@@+:=-::.:-=..-::*=#-+*+**+**+**+++-.::.............:+#::=+@%%%%%*===++#@*:...::=+..");
puts("*=+:*=@@@@@@@@@%%@%+*++=*=-.:----+=*=***+-+*++**=.==+-.:.+-=:.....:#@=--++@@-....=%%#++*@@%-:*+*:...");
puts("@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@%%@@@@@@@@@@%@@@@%@@@%%%%%@@@@@@@@@@@%%%%%%%@@@@@@@@@@@@@@%@");
puts("++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");

puts("");
puts("ALGO TERRiVEL(Porem nao inesperado) ACONTECE");
puts("nosso heroi deu de cara com um monstro cego, porem tao agil que conseguiu lhe matar sem nem mesmo ele perceber");
puts("Descanse em paz heroi, os dois nao viram o que aconteceu...");
puts("");
                system("pause");
                *vida-=1; // Perde uma vida
                *chavecoletada = 0; // Reseta a chave coletada
                mapa1[*y][*x] = '.'; // Corpo do player some antes de resetar
                *x = 1,*y=1; // Reseta a posição do player
                if(*fase==3){
                    RENICIARMAPA1(); // Reinicia o mapa 1
                    iniciarMapa(1); // Reinicia o mapa 1
                } else if(*fase==4){
                    RENICIARMAPA2(); // Reinicia o mapa 2
                    iniciarMapa2(); // Inicia o mapa 2
                } else if(*fase==5){
                    RENICIARMAPA3(); // Reinicia o mapa 3
                    iniciarMapa3(); // Inicia o mapa 3
					}
                }
                                            	if(mapa1[novay][novax] == '#'){
            		system("cls");



puts("................................-=--:::................................++=..=-..-*..................");
puts("................................=%****:..............................-+*:.......-*..................");
puts("................................=###%=.............................+#*-.........-*..................");
puts("................................:=*%%=::..........................=@@*.........+*-%=................");
puts("................................--++#%*+:........................-=............:+#*.................");
puts("................................:+++%@*+-........................+@:................................");
puts("........................==:::-=:..-+*%#+:.....................:=:@@:................................");
puts("......................:=:.....:==-=*@@=--..........:--:-+++++++#=@@:................................");
puts("......................=*:....*%==+-#%@@*-........-++-::=-:-=*+%@@@@:................................");
puts("......................+#-:..::.:=@%#=#=:........+-:++%+@@@@@@@*----.................................");
puts("......................=@@++*-:==.**-+%*=.......=--+%@@@@@@%+::......................................");
puts(".......................:#@@@@##%%%::=#-.......*-:-*@@@=.............................................");
puts(".........................-#@@@@@#::++=+:.....=---:#@%-................:+%-..........................");
puts(".......................:--#*++--:-:=-.:-=---##+==%@@*................:+-@=..........................");
puts("........................:++:+#%**+=..:.=--#*#%*##@@@-....==+=======++--@@=..........................");
puts(".....................++++==%%**@@@#==:::.-:@%*%@@@@#++=====+...:.-:*=%@@@=..........................");
puts("......................=*+##=+@@@@@@@@+--=-+*#:+#=--..:.++#@%@#@%@%%@@@@@#:..........................");
puts("....................=+****@%%-=%@@@@@@@@#%@@+.*-.===*@*@@@@#@@@@@%-:::::............................");
puts(".....................-#++%#*%=...-#@@@@@@@%*+*@=#@@#@@@@@=:.........................................");
puts("..................:=##+*%%-..::.....:-*#%@@@@@@@@@@@@@#-............................................");
puts("................:=..=###=:+:............:=*@@@@@@@##=:..............................................");
puts("..................=**%*:=-......................:+-::...............................................");
puts("..............::.=#%%#*:::.....:..........-........::.............::.....:..........:...............");
puts("........-=....*=:+#%%@::*=.-+.:#...+-.:*.:%........-*.:=:..+:.-=..=*....:*:....:=:.-*...............");
puts("........=+::..*=:-#:=@..*=.-#-=#...#=--%::%..*-.+=.-*--*:..#:-==..=*.:*.:*-%..*++:.-*..:-..-*.......");
puts("......::=++=--*+*=#.:@..*=.=#=+#.:=#=+=%=+%..*-:+=.-*++*:.-#:%==.-**.:*.:*-%:.*++:.**.*=+*=-*.......");
puts("......++=++===*+*=#+=@-=*+++#=+#-=+#=+=%=+%:**-#*=*+*++*:.*#-%==+=##=+*.#*-%==*++:.%*.%=+*=-*.......");
puts("......++=++%%=*+*=@#=@#+*%#+%#+#+%*#=+=%=+%:%%:#*#%+*++*+.*#-%==@###=%#.%#-@#=#+*-#%*.@#+*+=*.......");
puts("...:++*+=%%+*=*#%%%*@@=+*#%@%+@%+*%@=+=%*@@=@@:@@*+%#*%%=%##@%+@@+@#=@%:###%=%@%%*@@%-@@++*+*.=-....");
puts("....*%%@%**%@##@%=@%@@@%%##@@%@@%%*#%%%@@@@%@@:@@*@@@%%@%@##@%+@@#@@@#@#@%=@%+%@%*@@@@*%@@#%%%:.....");
puts("....=-+=++**=@-**#:##++@++**=*#+++#=#+#:*+@:*+#=-%=*=#+*=**+#+=++%+-%**:#**=*#-#*+#*=++%-#**:=*.....");
puts("..----.--.--..=-..+:.:=:-.:=..=-=..--..=:..=:...=:.:=..:+.:=.:-..=.:=..+:-.:=..=...=:.:=:.--:+.-:...");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");
puts("....................................................................................................");


puts("");
puts("ALGO INESPERADO ACONTECEU");
puts("Esses espinhos nunca foram projetados para matar ninguem,");
puts("eles foram feitos apenas para impedir que as pessoas passasem por locais indesejados da masmorra");
puts("Mas aparentemente nosso heroi conseguiu ser tao burro a ponto de tropecar e morrer para esses espinhos");
puts("Descanse em paz heroi, talvez seja melhor que ninguem lembre de voce assim...");
puts("");
                system("pause");
                *vida-=1; // Perde uma vida
                *chavecoletada = 0; // Reseta a chave coletada
                mapa1[*y][*x] = '.'; // Corpo do player some antes de resetar
                *x = 1,*y=1; // Reseta a posição do player
                if(*fase==3){
                    RENICIARMAPA1(); // Reinicia o mapa 1
                    iniciarMapa(1); // Reinicia o mapa 1
                } else if(*fase==4){
                    RENICIARMAPA2(); // Reinicia o mapa 2
                    iniciarMapa2(); // Inicia o mapa 2
                } else if(*fase==5){
                    RENICIARMAPA3(); // Reinicia o mapa 3
                    iniciarMapa3(); // Inicia o mapa 3
					}
                }
            }
        }
    // }
}


// Função para o inimigo lv:1
void bixinLV1(int *x, int *y, int *dire, int *vida, int *fase, int *chavecoletada, int *xp, int *yp) {
    int novax = *x, novay = *y;
    const int xorig = *x, yorig = *y; // Posição original do inimigo
    *dire = (rand() % 4);
    switch (*dire) {
        case 0: novay = *y - 1; break;
        case 1: novay = *y + 1; break;
        case 2: novax = *x + 1; break;
        case 3: novax = *x - 1; break;
        default: break;
    }
        if (mapa1[novay][novax] == '.') {
            mapa1[novay][novax] = 'X';
            mapa1[*y][*x] = '.';
            *y = novay;
            *x = novax;
        } else if (mapa1[novay][novax]=='&'){//Se o inimigo pegar o player
                if(*vida==0){
                system("cls");


puts("================-==----:-..::.:.........................................:..:.::------===============");
puts("===============------:::......................:::::::::::.....................-:-:-------===========");
puts("==============-----:::::...................-*+=========****+...............:....::--------==========");
puts("=============----:::::.................::+*=:-**%@@@@@%**+==##=..................::::::--=-=========");
puts("===========----:-::..................-+.:=%@@@@@@@@@@@@@@@@@+++*#=.................:::-------=======");
puts("==========-=---::::................-+-.-##@@@@@@@@@@@@@@@@@@@@%#*+*-................:::::---========");
puts("==========---:-:::................-+===.+%@@@@@@@@@@@@@@@@@@@@@@@#+*+:................:::----=======");
puts("========-------:.................+*::*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+*-.................::------=====");
puts("========------::................*=.=#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#+#:................:::-----=-===");
puts("=======------::::...............*=-#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+#:..................::--=--====");
puts("=====-------::::..............:%--#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@.................:::-------=");
puts("=====------::.................:%--#@@@@%*****#@@@@%*#@@%*****#%@@@@@%*%@.................::::------=");
puts("======-----::.................:%--#@@@@#.+##*:+%@@%:=%@#.=#%#--%@@@@%*%@...................:--:---==");
puts("====---=--:-::................:%--#@@@@#:+%@@%.=%@%:=@@#.=%@@%--#@@@%*%@.................::::------=");
puts("====-=----:::.................:%--#@@@@#:+%@@%.=%@%:=@@#.+%@@%--#@@@%*%@...................::-----==");
puts("=====-----:::.................:%--#@@@@#:+%@#-:=%@%:=@@#.=%@@-:#@@@@%*%@...................::------=");
puts("====--=---:-::................:%--#@@#:.....:*@@@@%:=@@#.....+%@@@@@%*%@...................:::----==");
puts("====------::::................:%-:#@@@@#:==-*%@@@@%:=@@#.+%@@@@@@@@@%*%@.................:::::-----=");
puts("=====-----::::................:%--#@@@@#:+%=:-#%@@%:=@@#.+%@@@@@@@@@%*%@................:::::---=--=");
puts("=====------::.................:%--#@@@@#.+%@#:=#@@%:=@@#.=%@@@@@@@@@%*%@................::::-------=");
puts("=======---:-:::...............:%--#@@@@#.+%@%*.=%@%:=@@#.=%@@@@@@@@@%*%@................:::::---====");
puts("=======------.................:%-:#@@@@%=*%@@%-*%@%=*@@#=*%@@@@@@@@@%*%@................:::-------==");
puts("========----:::...............:%--#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@................:::------===");
puts("========--=:-::...............:%--#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@................::::--======");
puts(":-=======-----::..............:%--=+#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@...............:::-----=====");
puts("-:-=======-----:..............:%--+*#*+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*%@..............:------=====:.");
puts("=---::====:--:----::........::=%--+%%%@@@@@@@@@@@@@@@@@%@@@@@+#@@@@@%*%@:::.........::-----===---..:");
puts("=--:-=+%***#*=-=+--::....:****%@--+%%+*@@@%=%+*%@@@@@@@#%=%@=%##@@@@%*%@@@%*=.....::--=+=#+=*#=:-===");
puts("==+*++##-%@@#**--=-=-+===++:--..........-=-...========-..=-...:=========-:-+%#====++++==*%@#%#-:==**");
puts("...............:........+*-%%%*#%%%%%%#%%%%%%%#%%%%%%%#%###*%%%%%%%#++#%#=*#*+......................");
puts("....................---.+*:*@%+*%@@*=%%@@@*=#@#%@@@@+*++*.+%@@@@@@@@@*:%@%%#**---=-.................");
puts(".:-.....................-=.--=:=++*=:++*+-+*==.=:+##=--=-####**+--##*=*#****++========-:::::::......");
puts("+#%#:....................................::..--:..:::..:...-...::::.::-::::.:::==-=------=------:...");
puts(".::-=-:........-----.........................:..:....::......:-..:-::.::..::::..:-.::...............");
puts("....................................................................................................");
puts("...........=.......=:**#*-.............................................................-......----:.");
puts("........:+-##=.......................................................:+**#+:........:.#+#=:......-=*");
puts(".......:#+%%@@:...................................................................%*#.%@@@=.........");
puts("...*##%%%%%%%%##+.........:-#-:*+#*-:..........................................*-##+##%%%%##=:......");
puts("..............:::===---:..-:.:...::-:.....................................................:::-=-----");
puts("....................................................................................................");
puts("......................--:---+*=-....................................................................");
puts("...............................:...............................................................:::::");
puts("........................................................................................::::........");
puts(".....:+###-:.............................................................::.:.......::*#-*##=::.....");

puts("");

                system("pause");
                system("cls");
                *vida=3; // Perde uma vida
                *chavecoletada = 0; // Reseta a chave coletada
                mapa1[*xp][*yp] = '.'; // Corpo do player some antes de resetar
                *xp = 1,*yp=1; // Reseta a posição do player
                *x = xorig, *y= yorig; // Reseta a posição do inimigo
                if(*fase==3){
                    RENICIARMAPA1(); // Reinicia o mapa 1
                    iniciarMapa(1); // Reinicia o mapa 1
                } else if(*fase==4){
                    RENICIARMAPA2(); // Reinicia o mapa 2
                    iniciarMapa2(); // Inicia o mapa 2
                } else if(*fase==5){
                    RENICIARMAPA3(); // Reinicia o mapa 3
                    iniciarMapa3(); // Inicia o mapa 3
                }
                *fase=0; //volta pro menu
                return; // Sai da função para não executar o resto do movimento e quebrar essa porcaria mais uma vez
            } else{
				system("cls");




puts("..=%%-.-=+=+#%*-+++@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=.=*%%+:.--:-=...........................");
puts("...:*+*#-+++*##%%%%%@@@%@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@-==+:.=+=....:*@%:...................");
puts(".::..:*@%++-+@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%##=:+*:--..-::%@@#:..................");
puts(":.=#.=+=%%%=*@@@@@@@@%#%@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=:%@%%-::=+:=:..:......................");
puts("*:=*.=*#@@@@@@@@@@@@@@@@%%@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@*#===:.:+=*..::.....:............");
puts("=@@#-@*.+@@@%@@@%%@@@@@@@@@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@%:..-%%-.:=:...-#=+...........");
puts(".-%%++%%@%@@@@%%%@@@%@@@@@@@@@@@@@@@@@@@=@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@%#+%%-.:.=%@#*=:.............");
puts("-#-:*%#@@@%%##@@@@@@%@@@@@@@@@@@@%@@@@%.-@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@*-+@+:+@:.:+..#=.........");
puts("%@*=@@@@@@%%@@@@@%@@@@@@%%@@%@@@@%@@@@%.-%+=@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@%=.-#@+.:*+%%-.........");
puts("#=@@@@@@%%%%@@@%##@@%#%@@@@##@@@@%##@@@@#:=#+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@-+@@*............");
puts("@%@@@@@@@@@@@@@@@@@@@@@@@@%@@@%#%@@@@@@@#+*-*+@#+**@@+#=%@*==#@@@@@@@@@@@@@@@@@@%@#@@%=+............");
puts("@@@@#@@@@@@@@@@#=*@@@@@@@@@%%#%%%#%@@@@@@@%+++-.-++#-%=*:......-===*#%%%@@@@@@@@%%@@%=.:............");
puts("@@%#@@@@@@@@+..==*@@@@@@@@@@@@@%@@@@@@@@@@@#+*.+++++=:#-............:+*@@@@@@@@@@@@@@@#==:...:=.....");
puts("@@@%@@@@@#-..::.*%*#@@@@@@%%@@@@@@@@@@@@@%@@@@@#***%@@-..............:-=#@@@@@@@%@@@%@@#-*-.........");
puts("@%%@@#%@*:..=+:.:*%@@@@%@@@@##%##%@@@@@@@@@@**@@@@@@@-......=:........-*=+*%@@@@@@@@@@@@@=..........");
puts("@@%@@@%%*.--..:+#*-.#@@@@@@@@@@@@@@@@@@@@*-::::+%@@*:....................=:.-*###%@@@@@%%%##::=.....");
puts("@@@@@@%=..==...--=*%@@@@@@@@@@@@@@@@@@@@%+-....::=-..................-=......-@.:*%@@@@@%%*=:+......");
puts("@@@@@*+*......==.*@@@@@@@@@@@@@@@@@@@@@@@@%+.==.::....-:.............-=....-::+...::+@@@@@@@#--:....");
puts("@@@@%:::..::..+**@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@+.++.+-..................=:::......=@@@@@@@@@#%@+...");
puts("@@@@%:..---=::+**@@@@%%@@@%@@@@@@@@@@@@@@@@@@@@@@%@%--=-...........=:.............:@@@@@@@@@@@@@@*..");
puts("@@@@@%=.--....-=#@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+::.:........-:............:@@@%==*@@@@@@@@@*-");
puts("@@@@@@@@@@+....=%@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#**-..:#:................:@@#....+@@@@%@@@@*");
puts("@@@@@@@@@@@@+..:+@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+:..+%:....=########@..:%@#...=%%=.%@@**@*");
puts("@@@%@@@#*@@@*.+*.#@@@%@@@@@@@@@@@@@@@@@@@%@@%####@@@@@%@@@@#:-=.....:%====....=*:..+*...+*:..:@@++@*");
puts("@@@@@=...-%@*...-%@@@@@@@@@@@@*:.....:=*@@@@@@@@@@@@@@@@%@@@%==-....:%-+#-%:..:%:.
